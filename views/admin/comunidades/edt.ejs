<%- include('../../cabecalho.ejs') %>
    <div style="margin-bottom: 20px;">
        <a href="/admin/comunidades/lst" class="card-link view">‚Üê Voltar para Comunidades</a>
    </div>
    <h1>Editar Comunidade</h1>
    <% if (erro) { %>
        <div style="color: red; margin-bottom: 16px; padding: 10px; background-color: #ffe0e0; border-radius: 4px;">
            <%= erro %>
        </div>
    <% } %>
    <form method="post" enctype="multipart/form-data">
        <label>Nome da Comunidade:</label>
        <input type="text" name="nome" value="<%= Comunidade.nome %>" required>
        
        <label>Descri√ß√£o:</label>
        <textarea name="descricao" required><%= Comunidade.descricao %></textarea>
        
        <label>Arte:</label>
        <select name="arte" required>
            <option value="">Selecione uma arte</option>
            <% Artes.forEach(arte => { %>
                <option value="<%= arte.titulo %>" <%= Comunidade.arte === arte.titulo ? 'selected' : '' %>>
                    <%= arte.titulo %>
                </option>
            <% }) %>
        </select>
        
        <label>Imagem:</label>
        <% if (Comunidade.imagem) { %>
            <div style="margin-bottom: 10px;">
                <img src="<%= Comunidade.imagem %>" alt="imagem" style="width:100px; height:auto">
            </div>
        <% } %>
        <input type="file" name="imagem" accept="image/*">
        
        <button type="submit">Atualizar</button>
    </form>

    <div style="margin-top: 40px; padding-top: 20px; border-top: 2px solid #ddd;">
        <h2>Posts da Comunidade</h2>
        <% if (posts && posts.length > 0) { %>
            <% posts.forEach(post => { %>
                <div style="background: white; border: 1px solid #ddd; border-radius: 4px; padding: 15px; margin-bottom: 15px;">
                    <div style="font-weight: 600; margin-bottom: 8px;">
                        <% if (post.artistaDeletado) { %>
                            üë§ Usu√°rio Deletado
                        <% } else { %>
                            <%= post.artista %>
                        <% } %>
                    </div>
                    <div style="color: #555; margin-bottom: 10px;">
                        <%= post.descricao %>
                    </div>
                    <% if (post.imagem) { %>
                        <img src="<%= post.imagem %>" style="max-width: 100%; max-height: 300px; margin-bottom: 10px; border-radius: 4px;">
                    <% } %>
                    <a href="#" class="btn delete" onclick="event.preventDefault(); openGlobalConfirm('/admin/comunidades/edt/<%= Comunidade._id %>/post/<%= post._id %>/del', 'Tem certeza que deseja deletar este post?')">Deletar</a>
                </div>
            <% }) %>
        <% } else { %>
            <p style="color: #999;">Nenhum post nesta comunidade ainda.</p>
        <% } %>
    </div>

    <%- include('../../rodape.ejs') %>
